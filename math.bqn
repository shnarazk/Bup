# Chinese Remainder Theorem
# that returns aâ€¿x such that:
# - x â‰¡ rr mod aq
# - x â‰¡ br mod bq
# where a is the modulo for x
CRT â‡ {bqâ€¿br ğ•Š aqâ€¿ar :
  n â† aqÃ·Ëœ(aqâŠ¸+)â€¢_while_(1â‰ bqâŠ¸|)0
  narâ€¿nbr â† bq|nÃ—arâ€¿br
  m â† (nar<nbr)â—¶âŸ¨bq+nbr-nar,nbr-narâŸ©@
  âŸ¨aqÃ—bq,ar+mÃ—aqâŸ©
}
# !8=1âŠ‘CRTÂ´âŸ¨5â€¿3,3â€¿2âŸ©
# !23=1âŠ‘CRTÂ´âŸ¨5â€¿3,3â€¿2,2â€¿7âŸ©
# (2â€¿0 CRT 5â€¿0)! 10â€¿10â‰¡2â€¿0 CRT 5â€¿0
# (3â€¿1 CRT 2â€¿0 CRT 5â€¿0)! 30â€¿40â‰¡3â€¿1 CRT 2â€¿0 CRT 5â€¿0

Permutations â‡ {
       ğ•Š n : (â†•n)ğ•ŠâŸ¨âŸ¨âŸ©âŸ© ;
    âŸ¨âŸ© ğ•Š l : l ;
    cs P l : âˆ¾{âŸ¨ğ•©âŸ©âŠ¸âˆ¾Â¨((ğ•©â‰ cs)âŠ¸/cs)P l}Â¨cs
  }