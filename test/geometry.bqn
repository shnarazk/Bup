#!/usr/bin/env cbqn
env ← {v⇐⍉>⊑∘⊐⟜'='⊸(↑⋈1↓↓)¨{-¬(¬×1++`)𝕩=@+10}⊸⊔1⊑•SH<"env",Var⇐{⊐⟜𝕩⊸⊏⟜(∾⟜@)˝v}}
geo‿util ← •Import¨"/geometry.bqn"‿"/util.bqn"∾˜¨<∾env.Var⋈"BQN_LIB"

∞ geo.Ext ↕3‿3
# ┌─
# ╵ ∞ ∞       ∞       ∞       ∞
#   ∞ ⟨ 0 0 ⟩ ⟨ 0 1 ⟩ ⟨ 0 2 ⟩ ∞
#   ∞ ⟨ 1 0 ⟩ ⟨ 1 1 ⟩ ⟨ 1 2 ⟩ ∞
#   ∞ ⟨ 2 0 ⟩ ⟨ 2 1 ⟩ ⟨ 2 2 ⟩ ∞
#   ∞ ∞       ∞       ∞       ∞
#                               ┘
geo.Ext⁼ geo.Ext ↕3‿3
# ┌─
# ╵ ⟨ 0 0 ⟩ ⟨ 0 1 ⟩ ⟨ 0 2 ⟩
#   ⟨ 1 0 ⟩ ⟨ 1 1 ⟩ ⟨ 1 2 ⟩
#   ⟨ 2 0 ⟩ ⟨ 2 1 ⟩ ⟨ 2 2 ⟩
#                           ┘

m5 ← 5‿5⥊↕25
1‿0‿∞ geo.Shift m5
1‿2‿¯∞ geo.Shift m5
# ┌─
# ╵ ¯∞ ¯∞ ¯∞ ¯∞ ¯∞
#   ¯∞ ¯∞  0  1  2
#   ¯∞ ¯∞  5  6  7
#   ¯∞ ¯∞ 10 11 12
#   ¯∞ ¯∞ 15 16 17
#                  ┘

1‿0 geo.Rotate m5
# ┌─
# ╵  5  6  7  8  9
#   10 11 12 13 14
#   15 16 17 18 19
#   20 21 22 23 24
#    0  1  2  3  4
#                  ┘
1‿2 geo.Rotate m5
# ┌─
# ╵  7  8  9  5  6
#   12 13 14 10 11
#   17 18 19 15 16
#   22 23 24 20 21
#    2  3  4  0  1
#                  ┘

m3 ← 3‿3⥊↕9
# ┌─
# ╵ 0 1 2
#   3 4 5
#   6 7 8
#         ┘
util.Debug ∞ geo.Neighbor5 m3
# ┌─
# ╵ ⟨ 0 ∞ 3 ∞ 1 ⟩ ⟨ 1 ∞ 4 0 2 ⟩ ⟨ 2 ∞ 5 1 ∞ ⟩
#   ⟨ 3 0 6 ∞ 4 ⟩ ⟨ 4 1 7 3 5 ⟩ ⟨ 5 2 8 4 ∞ ⟩
#   ⟨ 6 3 ∞ ∞ 7 ⟩ ⟨ 7 4 ∞ 6 8 ⟩ ⟨ 8 5 ∞ 7 ∞ ⟩
#                                             ┘
∞ geo.Neighbor9 m3
# ┌─
# ╵ ⟨ ∞ ∞ ∞ ∞ 0 1 ∞ 3 4 ⟩ ⟨ ∞ ∞ ∞ 0 1 2 3 4 5 ⟩ ⟨ ∞ ∞ ∞ 1 2 ∞ 4 5 ∞ ⟩
#   ⟨ ∞ 0 1 ∞ 3 4 ∞ 6 7 ⟩ ⟨ 0 1 2 3 4 5 6 7 8 ⟩ ⟨ 1 2 ∞ 4 5 ∞ 7 8 ∞ ⟩
#   ⟨ ∞ 3 4 ∞ 6 7 ∞ ∞ ∞ ⟩ ⟨ 3 4 5 6 7 8 ∞ ∞ ∞ ⟩ ⟨ 4 5 ∞ 7 8 ∞ ∞ ∞ ∞ ⟩
#                                                                     ┘

d3 ← ↕3‿3
# ┌─
# ╵ 0 1 2
#   3 4 5
#   6 7 8
#         ┘
util.Debug ∞ geo.Neighbor5 d3

util.Debug∾¨´⟨"AB","CD","EF"⟩‿⟨"ab","cd","ef"⟩‿⟨"01","2","345"⟩
util.Debug ⟨⟨⟩,⟨⟩,⟨⟩⟩<⊸∾¨´⟨"AB","CD","EF"⟩‿⟨"ab","cd","ef"⟩‿⟨"01","2","345"⟩
