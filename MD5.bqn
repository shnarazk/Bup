âŸ¨Md5âŸ© â‡
Encode32 â† {âˆ¾âŒ½((âŸ¨8â€¿'i',1âŸ©â€¢bit._cast)âˆ˜â‹ˆâˆ˜{127<ğ•© ? ğ•©-256 ; ğ•©})Â¨{ğ•©+16Ã—ğ•¨}Â´Ë˜âˆ˜â€¿2â¥Š"0123456789ABCDEF"âŠğ•©}
ToString â† âŠ‘âŸœ"0123456789abcdef"Â¨âˆ˜âˆ¾(16âŠ¸(âŒŠâˆ˜(Ã·Ëœ)â‹ˆ|){ğ•¨+2Ã—ğ•©}Â´)Â¨
masks â† Encode32Â¨âŸ¨
  "D76AA478","E8C7B756","242070DB","C1BDCEEE", "F57C0FAF","4787C62A","A8304613","FD469501",
  "698098D8","8B44F7AF","FFFF5BB1","895CD7BE", "6B901122","FD987193","A679438E","49B40821",
  "F61E2562","C040B340","265E5A51","E9B6C7AA", "D62F105D","02441453","D8A1E681","E7D3FBC8",
  "21E1CDE6","C33707D6","F4D50D87","455A14ED", "A9E3E905","FCEFA3F8","676F02D9","8D2A4C8A",
  "FFFA3942","8771F681","6D9D6122","FDE5380C", "A4BEEA44","4BDECFA9","F6BB4B60","BEBFBC70",
  "289B7EC6","EAA127FA","D4EF3085","04881D05", "D9D4D039","E6DB99E5","1FA27CF8","C4AC5665",
  "F4292244","432AFF97","AB9423A7","FC93A039", "655B59C3","8F0CCC92","FFEFF47D","85845DD1",
  "6FA87E4F","FE2CE6E0","A3014314","4E0811A1", "F7537E82","BD3AF235","2AD7D2BB","EB86D391",
âŸ©
coeffs â† âŸ¨
   0â€¿ 7, 1â€¿12, 2â€¿17, 3â€¿22, 4â€¿ 7, 5â€¿12, 6â€¿17, 7â€¿22, 8â€¿ 7, 9â€¿12,10â€¿17,11â€¿22,12â€¿ 7,13â€¿12,14â€¿17,15â€¿22,
   1â€¿ 5, 6â€¿ 9,11â€¿14, 0â€¿20, 5â€¿ 5,10â€¿ 9,15â€¿14, 4â€¿20, 9â€¿ 5,14â€¿ 9, 3â€¿14, 8â€¿20,13â€¿ 5, 2â€¿ 9, 7â€¿14,12â€¿20,
   5â€¿ 4, 8â€¿11,11â€¿16,14â€¿23, 1â€¿ 4, 4â€¿11, 7â€¿16,10â€¿23,13â€¿ 4, 0â€¿11, 3â€¿16, 6â€¿23, 9â€¿ 4,12â€¿11,15â€¿16, 2â€¿23,
   0â€¿ 6, 7â€¿10,14â€¿15, 5â€¿21,12â€¿ 6, 3â€¿10,10â€¿15, 1â€¿21, 8â€¿ 6,15â€¿10, 6â€¿15,13â€¿21, 4â€¿ 6,11â€¿10, 2â€¿15, 9â€¿21,
âŸ©
ADDâ€¿ANDâ€¿CASTâ€¿NOTâ€¿ORâ€¿XOR â† âŸ¨32â€¿1â€¢bit._add,32â€¿1â€¢bit._and,32â€¿1â€¢bit._cast,32â€¿1â€¢bit._not,32â€¿1â€¢bit._or,32â€¿1â€¢bit._xorâŸ©
ops â† {xâ€¿yâ€¿z: z XOR x AND y XOR z}â€¿{xâ€¿yâ€¿z: y XOR z AND x XOR y}â€¿{xâ€¿yâ€¿z: x XOR y XOR z}â€¿{xâ€¿yâ€¿z: y XOR x OR NOT z}
Md5 â† { # !âˆ§Â´(255âŠ¸â‰¥-âŸœ@)Â¨ğ•©
  âˆ¾(ToStringÂ·<Ë˜âˆ˜â€¿8âŠ¸â¥Š)Â¨(Encode32Â¨"67452301"â€¿"EFCDAB89"â€¿"98BADCFE"â€¿"10325476"){block ğ•Š ğ•©:
    Trans â† {n ğ•Š aâ€¿bâ€¿câ€¿d : kâ€¿s â† nâŠ‘coeffs â‹„ b ADD sâŒ½â¼a ADD((nâŒŠâˆ˜Ã·16)â—¶ops bâ€¿câ€¿d)ADD(kâŠ‘block)ADD nâŠ‘masks}
    ğ•© ADDÂ¨1âŠ‘{ğ•¨ ğ•Š aâ€¿bâ€¿câ€¿d : âŸ¨1+ğ•¨,âŸ¨d,ğ•¨ Trans ğ•©,b,câŸ©âŸ©}Â´â€¢_while_(64>âŠ‘)0â€¿ğ•©
  }Â´âŒ½(<<Ë˜)Ë˜âˆ˜â€¿16â€¿32â¥Š(CASTâŸ¨8Ã—â‰ ğ•©,0âŸ©)âˆ¾Ëœ{ğ•©âˆ¾8â†‘0}â€¢_while_(448â‰ 512|â‰ )âŸ¨0,0,0,0,0,0,0,1âŸ©âˆ¾ËœâŸ¨8â€¿'c',1âŸ©â€¢bit._cast ğ•©
}
